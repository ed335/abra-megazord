DATABASE_URL="postgresql://abracann_user:abracann_password@localhost:5432/abracann_dev"
root@srv1193160:~/abra-megazord/web# pm2 stop abracann-web
cd ~/abra-megazord/web
rm -rf .next
npm run build
pm2 restart abracann-web
[PM2] Applying action stopProcessId on app [abracann-web](ids: [ 9 ])
[PM2] [abracann-web](9) ✓
┌────┬─────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name            │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼─────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ abracann-api    │ default     │ N/A     │ fork    │ 0        │ 0      │ 6    │ stopped   │ 0%       │ 0b       │ root     │ disabled │
│ 9  │ abracann-web    │ default     │ N/A     │ fork    │ 0        │ 0      │ 0    │ stopped   │ 0%       │ 0b       │ root     │ disabled │
└────┴─────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘

> abracann-web@0.1.0 build
> next build

  ▲ Next.js 14.2.33
  - Environments: .env.local, .env

   Creating an optimized production build ...
 ✓ Compiled successfully
 ✓ Linting and checking validity of types    
 ✓ Collecting page data    
   Generating static pages (5/38)  [==  ]Erro ao exportar associados: B [Error]: Dynamic server usage: Route /api/admin/associados/export couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error
    at V (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:21778)
    at Object.get (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:29465)
    at p (/root/abra-megazord/web/.next/server/app/api/admin/associados/export/route.js:1:768)
    at x (/root/abra-megazord/web/.next/server/app/api/admin/associados/export/route.js:1:1289)
    at /root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:38417
    at /root/abra-megazord/web/node_modules/next/dist/server/lib/trace/tracer.js:140:36
    at NoopContextManager.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:7062)
    at ContextAPI.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:518)
    at NoopTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18093)
    at ProxyTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18854) {
  description: "Route /api/admin/associados/export couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error",
  digest: 'DYNAMIC_SERVER_USAGE'
}
Erro ao buscar associados: B [Error]: Dynamic server usage: Route /api/admin/associados couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error
    at V (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:21778)
    at Object.get (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:29465)
    at s (/root/abra-megazord/web/.next/server/app/api/admin/admins/[id]/route.js:1:2362)
    at d (/root/abra-megazord/web/.next/server/app/api/admin/associados/route.js:1:759)
    at /root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:38417
    at /root/abra-megazord/web/node_modules/next/dist/server/lib/trace/tracer.js:140:36
    at NoopContextManager.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:7062)
    at ContextAPI.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:518)
    at NoopTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18093)
    at ProxyTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18854) {
  description: "Route /api/admin/associados couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error",
  digest: 'DYNAMIC_SERVER_USAGE'
}
Erro ao gerar template: B [Error]: Dynamic server usage: Route /api/admin/associados/template couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error
    at V (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:21778)
    at Object.get (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:29465)
    at u (/root/abra-megazord/web/.next/server/app/api/admin/associados/template/route.js:1:685)
    at d (/root/abra-megazord/web/.next/server/app/api/admin/associados/template/route.js:1:951)
    at /root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:38417
    at /root/abra-megazord/web/node_modules/next/dist/server/lib/trace/tracer.js:140:36
    at NoopContextManager.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:7062)
    at ContextAPI.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:518)
    at NoopTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18093)
    at ProxyTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18854) {
  description: "Route /api/admin/associados/template couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error",
  digest: 'DYNAMIC_SERVER_USAGE'
}
Erro ao buscar estatísticas: B [Error]: Dynamic server usage: Route /api/admin/stats couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error
    at V (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:21778)
    at Object.get (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:29465)
    at s (/root/abra-megazord/web/.next/server/app/api/admin/admins/[id]/route.js:1:2362)
    at p (/root/abra-megazord/web/.next/server/app/api/admin/stats/route.js:1:761)
    at /root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:38417
    at /root/abra-megazord/web/node_modules/next/dist/server/lib/trace/tracer.js:140:36
    at NoopContextManager.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:7062)
    at ContextAPI.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:518)
    at NoopTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18093)
    at ProxyTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18854) {
  description: "Route /api/admin/stats couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error",
  digest: 'DYNAMIC_SERVER_USAGE'
}
   Generating static pages (13/38)  [=== ]Me error: B [Error]: Dynamic server usage: Route /api/auth/me couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error
    at V (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:21778)
    at Object.get (/root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:29465)
    at d (/root/abra-megazord/web/.next/server/app/api/auth/me/route.js:1:818)
    at /root/abra-megazord/web/node_modules/next/dist/compiled/next-server/app-route.runtime.prod.js:6:38417
    at /root/abra-megazord/web/node_modules/next/dist/server/lib/trace/tracer.js:140:36
    at NoopContextManager.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:7062)
    at ContextAPI.with (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:518)
    at NoopTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18093)
    at ProxyTracer.startActiveSpan (/root/abra-megazord/web/node_modules/next/dist/compiled/@opentelemetry/api/index.js:1:18854)
    at /root/abra-megazord/web/node_modules/next/dist/server/lib/trace/tracer.js:122:103 {
  description: "Route /api/auth/me couldn't be rendered statically because it used `request.headers`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error",
  digest: 'DYNAMIC_SERVER_USAGE'
}
 ✓ Generating static pages (38/38)
 ✓ Collecting build traces    
 ✓ Finalizing page optimization    

Route (app)                                   Size     First Load JS
┌ ○ /                                         17.8 kB         146 kB
├ ○ /_not-found                               873 B          88.2 kB
├ ○ /admin                                    5.19 kB         101 kB
├ ○ /admin/admins                             4.85 kB         101 kB
├ ○ /admin/agendamentos                       7.36 kB         103 kB
├ ○ /admin/associados                         9.85 kB         106 kB
├ ○ /admin/setup                              3.01 kB        99.1 kB
├ ○ /admin/whatsapp                           5.32 kB         101 kB
├ ƒ /api/admin/admins                         0 B                0 B
├ ƒ /api/admin/admins/[id]                    0 B                0 B
├ ƒ /api/admin/agendamentos                   0 B                0 B
├ ƒ /api/admin/agendamentos/[id]              0 B                0 B
├ ƒ /api/admin/agendamentos/stats             0 B                0 B
├ ƒ /api/admin/associados                     0 B                0 B
├ ƒ /api/admin/associados/[id]                0 B                0 B
├ ƒ /api/admin/associados/[id]/documentos     0 B                0 B
├ ƒ /api/admin/associados/[id]/toggle-status  0 B                0 B
├ ƒ /api/admin/associados/export              0 B                0 B
├ ƒ /api/admin/associados/import              0 B                0 B
├ ƒ /api/admin/associados/template            0 B                0 B
├ ƒ /api/admin/setup                          0 B                0 B
├ ○ /api/admin/setup/check                    0 B                0 B
├ ƒ /api/admin/stats                          0 B                0 B
├ ƒ /api/admin/whatsapp                       0 B                0 B
├ ƒ /api/auth/login                           0 B                0 B
├ ƒ /api/auth/me                              0 B                0 B
├ ƒ /api/auth/register-associado              0 B                0 B
├ ƒ /api/cep/[cep]                            0 B                0 B
├ ƒ /api/pre-anamnese                         0 B                0 B
├ ƒ /api/upload/documento-identidade          0 B                0 B
├ ƒ /api/upload/documentos-medicos            0 B                0 B
├ ○ /cadastro                                 7.2 kB          103 kB
├ ○ /cadastro/sucesso                         1.91 kB        89.2 kB
├ ○ /contato                                  1.22 kB        97.3 kB
├ ○ /dashboard                                6.75 kB         103 kB
├ ○ /doacoes                                  12.8 kB         109 kB
├ ○ /educacao                                 2.13 kB        98.2 kB
├ ○ /login                                    3.07 kB        99.1 kB
├ ○ /manifest.webmanifest                     0 B                0 B
├ ○ /pre-anamnese                             7.4 kB          103 kB
├ ○ /robots.txt                               0 B                0 B
└ ○ /sitemap.xml                              0 B                0 B
+ First Load JS shared by all                 87.3 kB
  ├ chunks/117-978fbe6ff93f0522.js            31.7 kB
  ├ chunks/fd9d1056-d22a852a8a2fb290.js       53.6 kB
  └ other shared chunks (total)               1.95 kB


ƒ Middleware                                  26.4 kB

○  (Static)   prerendered as static content
ƒ  (Dynamic)  server-rendered on demand

Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [abracann-web](ids: [ 9 ])
[PM2] [abracann-web](9) ✓
┌────┬─────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name            │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼─────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ abracann-api    │ default     │ N/A     │ fork    │ 0        │ 0      │ 6    │ stopped   │ 0%       │ 0b       │ root     │ disabled │
│ 9  │ abracann-web    │ default     │ N/A     │ fork    │ 1700704  │ 0s     │ 0    │ online    │ 0%       │ 16.8mb   │ root     │ disabled │
└────┴─────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
root@srv1193160:~/abra-megazord/web# pm2 show abracann-web
 Describing process with id 9 - name abracann-web 
┌───────────────────┬────────────────────────────────────────┐
│ status            │ online                                 │
│ name              │ abracann-web                           │
│ namespace         │ default                                │
│ version           │ N/A                                    │
│ restarts          │ 0                                      │
│ uptime            │ 3s                                     │
│ script path       │ /usr/bin/npm                           │
│ script args       │ start                                  │
│ error log path    │ /root/.pm2/logs/abracann-web-error.log │
│ out log path      │ /root/.pm2/logs/abracann-web-out.log   │
│ pid path          │ /root/.pm2/pids/abracann-web-9.pid     │
│ interpreter       │ /usr/bin/node                          │
│ interpreter args  │ N/A                                    │
│ script id         │ 9                                      │
│ exec cwd          │ /root/abra-megazord/web                │
│ exec mode         │ fork_mode                              │
│ node.js version   │ 20.19.6                                │
│ node env          │ N/A                                    │
│ watch & reload    │ ✘                                      │
│ unstable restarts │ 0                                      │
│ created at        │ 2025-12-21T15:22:43.361Z               │
└───────────────────┴────────────────────────────────────────┘
 Actions available 
┌────────────────────────┐
│ km:heapdump            │
│ km:cpu:profiling:start │
│ km:cpu:profiling:stop  │
│ km:heap:sampling:start │
│ km:heap:sampling:stop  │
└────────────────────────┘
 Trigger via: pm2 trigger abracann-web <action_name>

 Code metrics value 
┌────────────────────────┬───────────┐
│ Used Heap Size         │ 10.59 MiB │
│ Heap Usage             │ 64.28 %   │
│ Heap Size              │ 16.48 MiB │
│ Event Loop Latency p95 │ 0.58 ms   │
│ Event Loop Latency     │ 0.05 ms   │
│ Active handles         │ 5         │
│ Active requests        │ 0         │
└────────────────────────┴───────────┘
 Divergent env variables from local env 


 Add your own code metrics: http://bit.ly/code-metrics
 Use `pm2 logs abracann-web [--lines 1000]` to display logs
 Use `pm2 env 9` to display environment variables
 Use `pm2 monit` to monitor CPU and Memory usage abracann-web
root@srv1193160:~/abra-megazord/web# env | grep DATABASE
root@srv1193160:~/abra-megazord/web# cat /etc/environment | grep DATABASE
root@srv1193160:~/abra-megazord/web# 